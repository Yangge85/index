<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>登录</title>
    <style>
        body {
            font-family: "微软雅黑", serif;
            background: #f5f5f5;
        }
        .leftimg {
            float: left;
            width: 16px;
            height: 20px;
            margin-top: 10px;
        }
        .cinput {
            width: 210px;
            height: 35px;
            line-height: 35px;
            padding-left: 10px;
            color: #D3D3D3;
            border: none;
            background: #FFFFFF;
            font-size: 16px;
        }
    </style>
    <script>
        function userKeyDown(event) {
            var keycode = (Number)(event.keyCode);
            if (keycode === 13) {
                document.getElementById('pwdholder').onfocus();
            }
        }

        function pwdKeyDown(event) {
            var keycode = (Number)(event.keyCode);
            if (keycode === 13) {
                Login()
            }
        }
    </script>
</head>
<body scroll="no" oncontextmenu=self.event.returnValue=false
      style="background-image: url(images/loginbj.jpg);background-repeat:no-repeat;">
<div style="position:absolute;margin-top: 15px;margin-left: 100px">
    <i id="proname" style="color: #FFFFFF;font-size: 14pt;font-weight: bold"></i>
</div>
<div style="position:absolute;margin-top: 380px;width: 478px;text-align: center">
    <p id="unitname" style="display: inline;color: #FFFFFF;font-size: 12pt;cursor: pointer;" onclick="changeUnitno()"><u id="uunitname"></u></p>
    <div id="schreg" style="display: inline;color: #FFD700;font-size: 12pt;cursor: pointer;visibility:hidden" onclick="schReg()">&nbsp;<u>注册机</u></div>
    <p id="wsno" style="color: #FFD700;display: inline;visibility:hidden">&nbsp;</p>
</div>
<div style="position:absolute;width: 320px;background: #FFFFFF;text-align: center;margin-top: 110px;margin-left: 480px">
<!--    标题-->
    <div style="font-size: 18pt;font-weight: bold;color: #1890ff;margin-bottom: 20px">
        学员登录
    </div>
<!--    输入框-->
    <div style="height: 40px;width:80%;border-bottom: 1px solid #d0d0d0;">
        <img class="leftimg"
             src="images/user.jpg"/>
        <input id="user" class="cinput" type="text" value="请输入学号" placeholder="请输入学号"
               onfocus="var userI=document.getElementById('user');if (userI.value==='请输入学号'){userI.value='';userI.style.color='#000000'}"
               onblur="var userI=document.getElementById('user');if (userI.value===''){userI.value='请输入学号';userI.style.color='#D3D3D3'}"
               onkeydown="userKeyDown(event)" onkeyup="value=value.replace(/[^\w]/ig,'')"/>
    </div>
    <div style="height: 40px;width:80%;margin-top: 20px;border-bottom: 1px solid #d0d0d0;">
        <img class="leftimg"
             src="images/pwd.jpg"/>
        <input id="pwdvalue" class="cinput" type="password" style="color: #000000;display: none"
               onblur="var pwdvalueI=document.getElementById('pwdvalue');if (pwdvalueI.value===''){pwdvalueI.style.display='none';document.getElementById('pwdholder').style.display='block';}"
               onkeydown="pwdKeyDown(event)">
        <input id="pwdholder" class="cinput" type="text" value="请输入密码"
               onfocus="var pwdholderI=document.getElementById('pwdholder');if (pwdholderI.value==='请输入密码'){pwdholderI.style.display='none';document.getElementById('pwdvalue').style.display='block';document.getElementById('pwdvalue').focus();}"/>
    </div>
<!--    按钮-->
    <div style="margin-top: 30px;text-align: center">
        <div style="width: 70%;height: 46px;line-height: 46px;text-align: center;font-size: 18px;color: #fff;background: #1890ff;cursor: pointer;font-weight: bold;"
             onclick="Login()">
            登录
        </div>
    </div>
<!--    <div style="margin-top: 10px;margin-left: -320px">-->
<!--        <div style="position:absolute;width: 100%;text-align: center">-->
<!--            <p id="wsno" style="color: #999;display: inline;visibility:hidden"></p>-->
<!--        </div>-->
<!--        <div id="schreg" style="position:absolute;width: 100%;text-align: center;color: #1890ff;cursor: pointer;visibility:hidden" onclick="schReg()">学校注册</div>-->
<!--    </div>-->
</div>
<input name="hidden" type="hidden" ID="txtCommand" value="" style="display: none">
<input name="button" type="button" ID="btnCallVB" style="display: none">
</body>
<script language="vbscript">
   sub Login()
       Dim user
       Dim pwd
       user=Document.All("user").Value
       pwd=Document.All("pwdvalue").Value
       if user="请输入学号" then user="" end if
	   txtCommand.value="LOGIN//" & user & "//" & pwd
       btnCallVB.click
	end sub

    sub schReg()
	   txtCommand.value="schReg//"
       btnCallVB.click
	end sub


	sub changeUnitno()
	   txtCommand.value="changeUnitno//"
       btnCallVB.click
	end sub
</script>
<script language="javascript">

    function KeyDown() {
        // alert(window.event.keyCode);
        if ((window.event.altKey) &&
            ((window.event.keyCode == 37) || //屏蔽 Alt+ 方向键 ←
                (window.event.keyCode == 39))) { //屏蔽 Alt+ 方向键 →
            // alert("不准你使用ALT+方向键前进或后退网页！");
            event.returnValue = false;
        }
        if ((event.keyCode == 8) || //屏蔽退格删除键
            (event.keyCode == 116) || //屏蔽 F5 刷新键
            (event.ctrlKey && event.keyCode == 82)) { //Ctrl + R
            event.keyCode = 0;
            event.returnValue = false;
        }
        if ((event.ctrlKey) && (event.keyCode == 78)) //屏蔽 Ctrl+n
            event.returnValue = false;
        if ((event.shiftKey) && (event.keyCode == 121)) //屏蔽 shift+F10
            event.returnValue = false;
        if (window.event.srcElement.tagName == "A" && window.event.shiftKey)
            window.event.returnValue = false; //屏蔽 shift 加鼠标左键新开一网页
        if ((window.event.altKey) && (window.event.keyCode == 115)) { //屏蔽Alt+F4
            window.showModelessDialog("about:blank", "", "dialogWidth:1px;dialogheight:1px");
            return false;
        }
    }
    document.oncontextmenu = mylock1;
    function mylock1() {
        event.returnValue = false;
    }
    document.onkeydown = KeyDown
    function KeyDown(e) {
        if ((window.event.altKey) &&
            ((window.event.keyCode == 37) ||     //屏蔽 Alt+ 方向键 ←
                (window.event.keyCode == 39))) {    //屏蔽 Alt+ 方向键 →
            alert("不准你使用ALT+方向键前进或后退网页！");
            event.returnValue = false;
        }
        if ((event.keyCode == 116) ||                   //屏蔽 F5 刷新键
            (event.keyCode == 112) ||                   //屏蔽 F1
            (event.ctrlKey && event.keyCode == 82)) { //Ctrl + R
            event.keyCode = 0;
            event.returnValue = false;
        }
        if ((event.ctrlKey) && (event.keyCode == 78))     //屏蔽 Ctrl+n
            event.returnValue = false;
        if ((event.shiftKey) && (event.keyCode == 121)) //屏蔽 shift+F10
            event.returnValue = false;
        if (event.keyCode == 121) //屏蔽 F10
        {
            event.keyCode = 0;
            event.returnValue = false;
        }
        if (event.keyCode == 122) //屏蔽 F11
        {
            event.keyCode = 0;
            event.returnValue = false;
        }
        if (event.keyCode == 116) //屏蔽 F5
        {
            event.keyCode = 0;
            event.returnValue = false;
        }
        if (event.keyCode == 112) //屏蔽 F1
        {
            event.keyCode = 0;
            event.returnValue = false;
        }
        if (event.keyCode == 114) //屏蔽 F3
        {
            event.keyCode = 0;
            event.returnValue = false;
        }
        if (window.event.srcElement.tagName == "A" && window.event.shiftKey)
            window.event.returnValue = false;    //屏蔽 shift 加鼠标左键新开一网页
        if ((window.event.altKey) && (window.event.keyCode == 115)) { //屏蔽Alt+F4
            window.showModelessDialog("about:blank", "", "dialogWidth:1px;dialogheight:1px");
            return false;
        }
        if (event.keyCode == 8) //屏蔽删除键返回上一页
        {
            var ev = e || window.event;//获取event对象
            var obj = ev.target || ev.srcElement;//获取事件源
            var t = obj.type || obj.getAttribute('type');//获取事件源类型
            //获取作为判断条件的事件类型
            var vReadOnly = obj.getAttribute('readonly');
            var vEnabled = obj.getAttribute('enabled');
            //处理null值情况
            vReadOnly = (vReadOnly == null) ? false : vReadOnly;
            vEnabled = (vEnabled == null) ? true : vEnabled;
            //当敲Backspace键时，事件源类型为密码或单行、多行文本的，
            //并且readonly属性为true或enabled属性为false的，则退格键失效
            var flag1 = (ev.keyCode == 8 && (t == "password" || t == "text" || t == "textarea") && (vReadOnly == true || vEnabled != true)) ? true : false;
            //当敲Backspace键时，事件源类型非密码或单行、多行文本的，则退格键失效
            var flag2 = (ev.keyCode == 8 && t != "password" && t != "text" && t != "textarea") ? true : false;
            //判断
            if (flag2) {
                return false;
            }
            if (flag1) {
                return false;
            }
        }
        if (event.keyCode == 13) //屏蔽回车键打开文件夹
        {
            var ev = e || window.event;//获取event对象
            var obj = ev.target || ev.srcElement;//获取事件源
            var t = obj.type || obj.getAttribute('type');//获取事件源类型
            //获取作为判断条件的事件类型
            var vReadOnly = obj.getAttribute('readonly');
            var vEnabled = obj.getAttribute('enabled');
            //处理null值情况
            vReadOnly = (vReadOnly == null) ? false : vReadOnly;
            vEnabled = (vEnabled == null) ? true : vEnabled;
            //当敲Backspace键时，事件源类型为密码或单行、多行文本的，
            //并且readonly属性为true或enabled属性为false的，则回车键失效
            var flag1 = (ev.keyCode == 13 && (t == "password" || t == "text" || t == "textarea") && (vReadOnly == true || vEnabled != true)) ? true : false;
            //当敲回车键时，事件源类型非密码或单行、多行文本的，则退格键失效
            var flag2 = (ev.keyCode == 13 && t != "password" && t != "text" && t != "textarea") ? true : false;
            //判断
            if (flag2) {
                return false;
            }
            if (flag1) {
                return false;
            }
        }
    }

</script>
</html>
